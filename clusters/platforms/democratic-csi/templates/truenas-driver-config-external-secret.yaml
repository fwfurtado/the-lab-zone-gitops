---
# Syncs the full TrueNAS driver config from 1Password into a Secret used by democratic-csi.
# 1Password: create an item (e.g. "TrueNAS Democratic CSI") and put the full driver-config
# YAML in the "notes" field (or use key: "Item Name/field" for a custom field).
# Example content for the 1Password notes field: see README in this directory.
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: truenas-driver-config
  namespace: {{ .Release.Namespace }}
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: onepassword
    kind: ClusterSecretStore
  target:
    name: truenas-driver-config
    creationPolicy: Owner
  data:
    - secretKey: driver-config-file.yaml
      remoteRef:
        key: "k8s-csi/notes"
