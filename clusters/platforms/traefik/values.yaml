traefik:
  # Single replica is fine for homelab
  deployment:
    replicas: 1

  # Fixed IP from MetalLB pool - this is what Traefik LXC will point to
  service:
    type: LoadBalancer
    annotations:
      metallb.universe.tf/loadBalancerIPs: "10.40.2.1"

  # Entrypoints - only HTTP since TLS terminates at Traefik LXC
  ports:
    web:
      port: 8000
      exposedPort: 80
      protocol: TCP
    # Disable HTTPS - TLS is handled by Traefik LXC
    websecure:
      port: 8443
      exposedPort: 443
      protocol: TCP
    gitea-ssh:
      port: 2222
      exposedPort: 22
      protocol: TCP

  tracing:
    otlp:
      enabled: true
      endpoint: "http://victoria-vt-single-server.monitoring.svc.cluster.local:10428/insert/opentelemetry/v1/traces"
    sampleRate: 1

  metrics:
    prometheus:
      service:
        enabled: true
      serviceMonitor:
        enabled: true

  # Enable Traefik dashboard (exposed via IngressRoute below)
  ingressRoute:
    dashboard:
      enabled: true
      matchRule: Host(`traefik.platform.the-lab.zone`)
      entryPoints:
        - web

  # Providers
  providers:
    kubernetesCRD:
      enabled: true
      allowCrossNamespace: true
    kubernetesIngress:
      enabled: true
      allowEmptyServices: true

  # Logs
  logs:
    general:
      level: INFO
      format: json
    access:
      enabled: true

  # Resources
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 256Mi
